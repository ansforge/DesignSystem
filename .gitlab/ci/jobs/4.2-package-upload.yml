.package:upload:
  stage: packaging
  needs: ["package_generate"]
  extends: .package_variables
  rules:
  - !reference [.build_rules, rules]
  script: # upload to git externe packages
    - apk add curl
    - echo "${PACKAGE_REGISTRY_URL}/${RELEASE_NAME}/${PACKAGE_NAME}"
    - 'curl --header "PRIVATE-TOKEN: $EXTERNAL_GIT_TOKEN" --upload-file ${PACKAGE_NAME} "${PACKAGE_REGISTRY_URL}/${RELEASE_NAME}/${PACKAGE_NAME}"'
  release:
    name: 'Ressources $RELEASE_NAME'
    tag_name: '$RELEASE_NAME'
    ref: '$CI_COMMIT_SHA'
